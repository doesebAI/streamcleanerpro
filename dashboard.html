<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StreamPilot ‚Äì Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --secondary: #1e293b;
      --light: #f8fafc;
      --muted: #64748b;
      --border: #e5e7eb;
      --success: #16a34a;
      --warning: #f59e0b;
      --danger: #dc2626;
    }
    
    body { 
      font-family: 'Segoe UI', sans-serif; 
      margin: 0; 
      background: var(--light); 
      color: var(--secondary); 
    }
    
    .dashboard { 
      display: flex; 
      flex-direction: row; 
      min-height: 100vh; 
    }
    
    .sidebar { 
      background: var(--secondary); 
      color: white; 
      padding: 2rem 1.5rem; 
      width: 240px; 
    }
    
    .sidebar h1 { 
      font-size: 1.5rem; 
      margin-bottom: 2rem; 
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .sidebar nav a { 
      display: block; 
      color: #cbd5e1; 
      text-decoration: none; 
      margin: 1rem 0; 
      font-weight: 500; 
      transition: color 0.2s; 
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .sidebar nav a:hover { 
      color: var(--primary); 
    }
    
    .dashboard-content { 
      flex: 1; 
      padding: 2rem 3rem; 
      display: flex; 
      flex-direction: column; 
      gap: 2rem; 
      background: linear-gradient(to bottom right, #f1f5f9, #e2e8f0); 
    }
    
    .dashboard-card { 
      background: white; 
      padding: 1.25rem; 
      border-radius: 1rem; 
      box-shadow: 0 10px 20px rgba(0,0,0,0.05); 
    }
    
    h2 i { 
      margin-right: 0.5rem; 
      color: var(--primary); 
    }
    
    .stream-dropdown, input, textarea, select { 
      width: 100%; 
      margin-top: .6rem; 
      padding: 1rem; 
      border: 1px solid var(--border); 
      border-radius: 0.5rem; 
      font-size: 1rem; 
      box-sizing: border-box;
    }
    
    button { 
      background: var(--primary); 
      color: white; 
      border: none; 
      padding: 0.9rem 1.2rem; 
      border-radius: 0.5rem; 
      font-size: 1rem; 
      margin-top: .5rem; 
      cursor: pointer; 
      transition: background 0.2s;
    }
    
    button:hover { 
      background: var(--primary-dark); 
    }
    
    button:disabled {
      background: var(--muted);
      cursor: not-allowed;
    }
    
    .file-status { 
      font-size: 0.9rem; 
      color: var(--muted); 
      margin-top: 0.5rem; 
    }
    
    .toggle-row { 
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      margin: 0.75rem 0; 
    }
    
    .toggle-row label { 
      font-weight: 500; 
    }
    
    .muted { 
      color: var(--muted); 
      font-size: 0.85rem; 
      margin-top: 0.25rem; 
    }
    
    .balance { 
      font-size: 1.8rem; 
      font-weight: 700; 
      margin-bottom: 0.5rem; 
    }
    
    table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-top: 1rem; 
    }
    
    th, td { 
      padding: 0.75rem; 
      border-bottom: 1px solid var(--border); 
      text-align: left; 
      font-size: 0.95rem; 
    }
    
    th { 
      background: #f1f5f9; 
    }
    
    .status-paid { 
      color: var(--success); 
      font-weight: 600; 
    }
    
    .status-pending { 
      color: var(--warning); 
      font-weight: 600; 
    }
    
    .status-rejected { 
      color: var(--danger); 
      font-weight: 600; 
    }
    
    @media screen and (max-width: 900px) {
      .dashboard { 
        flex-direction: column; 
      }
      
      .sidebar { 
        width: 100%; 
        display: flex; 
        flex-wrap: wrap; 
        justify-content: space-around; 
      }
      
      .sidebar h1 { 
        display: none; 
      }
      
      .dashboard-content { 
        padding: 1.25rem; 
      }
      
      button { 
        width: 100%; 
      }
    }
    
    .dashboard-card canvas {
      min-height: 300px !important;
      width: 100% !important;
    }
    
    .stats-table table { 
      width: 100%; 
      border-collapse: collapse; 
    }
    
    .stats-table th { 
      background: var(--light); 
      padding: 12px; 
      text-align: left; 
    }
    
    .stats-table td { 
      padding: 12px; 
      border-bottom: 1px solid var(--border); 
    }
    
    .bar-wrapper { 
      background: #f1f5f9; 
      border-radius: 4px; 
      height: 24px; 
      position: relative; 
    }
    
    .bar { 
      position: absolute; 
      left: 0; 
      top: 0; 
      height: 100%; 
      border-radius: 4px; 
      padding: 0 8px; 
      line-height: 24px; 
      color: white; 
    }
    
    .bar.traffic { 
      background: var(--primary-dark); 
    }
    
    .bar.revenue { 
      background: var(--success); 
    }
    
    .card { 
      border: 1px solid var(--border); 
      border-radius: 0.5rem; 
      padding: 1rem; 
      margin: 0.5rem 0; 
      cursor: pointer; 
      transition: all 0.2s;
    }
    
    .card:hover { 
      background-color: #f1f5f9; 
      border-color: var(--primary);
    }
    
    .card.selected { 
      background-color: #dbeafe; 
      border-color: var(--primary);
    }
    
    .preview iframe { 
      width: 100%; 
      height: 400px; 
      border: none; 
      border-radius: 0.5rem; 
      margin-top: 1rem;
    }
    
    /* Quick Stats Styles */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      border: 1px solid #e2e8f0;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: var(--muted);
      font-weight: 500;
      margin-bottom: 0.5rem;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--secondary);
      margin-bottom: 0.5rem;
    }
    
    .stat-trend {
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
    }
    
    .stat-trend.positive {
      color: var(--success);
    }
    
    .stat-trend.negative {
      color: var(--danger);
    }
    
    .stat-trend.neutral {
      color: var(--muted);
    }
    
    .stat-trend i {
      margin-right: 0.25rem;
    }
    
    /* Experience vs Earnings Balance */
    .balance-indicator {
      margin: 1.5rem 0;
      padding: 1rem;
      background: #f8fafc;
      border-radius: 0.5rem;
      border: 1px solid var(--border);
    }
    
    .balance-slider {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 0.5rem;
    }
    
    .balance-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 0.25rem;
      font-size: 0.85rem;
      color: var(--muted);
    }
    
    .balance-bar {
      flex: 1;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      margin: 0 1rem;
      position: relative;
    }
    
    .balance-fill {
      position: absolute;
      height: 100%;
      border-radius: 4px;
      background: linear-gradient(to right, var(--primary), var(--success));
      transition: width 0.3s;
    }
    
    /* Success Message */
    .success-message {
      background: #d1fae5;
      color: var(--success);
      padding: 1rem;
      border-radius: 0.5rem;
      margin-top: 1rem;
      display: none;
    }
    
    /* Domain Selection */
    .domain-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .domain-card {
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }
    
    .domain-card:hover {
      border-color: var(--primary);
      background: #f1f5f9;
    }
    
    .domain-card.selected {
      border-color: var(--primary);
      background: #dbeafe;
    }
    
    /* Validation Styles */
    .validation-error {
      color: var(--danger);
      font-size: 0.85rem;
      margin-top: 0.25rem;
      display: none;
    }
    
    input.error, select.error {
      border-color: var(--danger);
    }
  </style>
</head>
<body>
<section class="dashboard">
  <aside class="sidebar">
    <h1><i class="fas fa-rocket"></i> StreamPilot</h1>
    <nav>
      <a href="#tool"><i class="fas fa-tv"></i> Stream Tool</a>
      <a href="#stats"><i class="fas fa-chart-simple"></i> Quick Stats</a>
      <a href="#withdrawals"><i class="fas fa-wallet"></i> Withdrawals</a>
      <a href="#profile"><i class="fas fa-user-circle"></i> Profile</a>
      <a href="#support"><i class="fas fa-comment-dots"></i> Support</a>
      <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </nav>
  </aside>

  <main class="dashboard-content">

    <!-- Stream Tool -->
    <div id="tool" class="dashboard-card">
      <h2><i class="fas fa-tv"></i> Stream Tool</h2>

      <!-- Step 1 -->
      <h3>Step 1: Select Stream</h3>
      <select id="streamSelect" class="stream-dropdown"><option>Loading‚Ä¶</option></select>
      <div id="thumbList" style="margin-top:10px"></div>
      <div id="matchPreview" class="preview" style="display:none;"></div>

      <!-- Step 2 -->
      <h3 style="margin-top:16px">Step 2: Enable Monetization</h3>
      <div class="toggle-row">
        <label>Enable Monetization</label>
        <input type="checkbox" id="enableMonetization"/>
      </div>

      <div id="monetizationOptions" style="display:none; margin-top:1rem">
        <div class="toggle-row">
          <label>Native Banner Ads</label>
          <input type="checkbox" id="enableNativeBanners" />
        </div>
        <p class="muted">CPM-based ads shown on all devices.</p>
        
        <div class="toggle-row">
          <label>Popunders</label>
          <input type="checkbox" id="enablePopunders" />
        </div>
        <p class="muted">Popunder ads that appear when users interact with the page.</p>
        
        <div class="toggle-row">
          <label>Content Locker (CPL)</label>
          <input type="checkbox" id="enableContentLocker" />
        </div>
        <p class="muted">Visitors must complete an offer to unlock the stream after 45 minutes.</p>
        
        <div class="toggle-row">
          <label>Standard Banners (CPM)</label>
          <input type="checkbox" id="enableStandardBanners" />
        </div>
        <p class="muted">Traditional banner ads placed throughout the page.</p>
        
        <div class="toggle-row">
          <label>SmartLink Redirect (CPI)</label>
          <input type="checkbox" id="enableSmartlink" />
        </div>
        <p class="muted">Redirects users to offers based on their device and location.</p>
        
        <!-- Experience vs Earnings Balance Indicator -->
        <div class="balance-indicator">
          <div class="toggle-row">
            <label>User Experience vs Earnings Balance</label>
          </div>
          <div class="balance-slider">
            <span>üòê User Experience</span>
            <div class="balance-bar">
              <div class="balance-fill" id="balanceFill" style="width: 50%;"></div>
            </div>
            <span>üí∞ Earnings</span>
          </div>
          <div class="balance-labels">
            <span>Less Intrusive</span>
            <span>More Intrusive</span>
          </div>
        </div>
      </div>

      <!-- Step 3 -->
      <h3 style="margin-top:16px">Step 3: Choose Domain & Launch</h3>
      <div class="domain-options" id="domainOptions">
        <label for="domainSelect" style="font-weight:600;display:block;margin-bottom:8px">Choose domain</label>
        <select id="domainSelect" class="stream-dropdown">
          <option value="">-- Choose a domain --</option>
          <option value="https://kattarra.netlify.app/">kattarra.netlify.app</option>
          <option value="https://iroohh.netlify.app/">iroohh.netlify.app</option>
          <option value="https://zuuko.netlify.app/">zuuko.netlify.app</option>
          <option value="https://ozulastream.netlify.app/">ozulastream.netlify.app</option>
          <option value="https://ozaistream.netlify.app/">ozaistream.netlify.app</option>
        </select>
      </div>
      
      <button id="launchBtn">üöÄ Launch Stream</button>
      <div id="launchStatus" class="file-status">Select a domain to launch your stream</div>
      <div id="successMessage" class="success-message"></div>
    </div>

    <!-- Quick Stats Section -->
    <section id="stats" class="dashboard-card">
      <h2><i class="fas fa-chart-simple"></i> Quick Stats</h2>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Impressions</div>
          <div class="stat-value" id="stat-impressions">0</div>
          <div class="stat-trend positive"><i class="fas fa-arrow-up"></i> Real-time</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Clicks</div>
          <div class="stat-value" id="stat-clicks">0</div>
          <div class="stat-trend neutral"><i class="fas fa-minus"></i> Real-time</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">CTR</div>
          <div class="stat-value" id="stat-ctr">0%</div>
          <div class="stat-trend neutral"><i class="fas fa-minus"></i> Click rate</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">CPM</div>
          <div class="stat-value" id="stat-cpm">$0.00</div>
          <div class="stat-trend positive"><i class="fas fa-arrow-up"></i> Est.</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Revenue</div>
          <div class="stat-value" id="stat-revenue">$0.00</div>
          <div class="stat-trend positive"><i class="fas fa-arrow-up"></i> Est.</div>
        </div>
      </div>
    </section>

    <!-- Withdrawals -->
    <section id="withdrawals" class="dashboard-card">
      <h2><i class="fas fa-wallet"></i> Withdrawals</h2>
      <div class="balance">$0.00</div>
      <p class="muted">Available Balance (Minimum $30 to withdraw)</p>
      
      <h3>Earnings Breakdown</h3>
      <table>
        <tr><th>Source</th><th>Amount</th></tr>
        <tr><td>Native Banner Ads</td><td>$0.00</td></tr>
        <tr><td>Popunders</td><td>$0.00</td></tr>
        <tr><td>Content Locker (CPL)</td><td>$0.00</td></tr>
        <tr><td>Standard Banners</td><td>$0.00</td></tr>
        <tr><td>SmartLink Redirect</td><td>$0.00</td></tr>
      </table>
      
      <h3 style="margin-top:1.5rem">Request Withdrawal</h3>
      <input type="email" id="paypalEmail" placeholder="PayPal Email Address" />
      <div id="paypalEmailError" class="validation-error">Please enter a valid PayPal email address</div>
      
      <input type="number" id="withdrawalAmount" placeholder="Amount (USD)" min="30" step="0.01" />
      <div id="withdrawalAmountError" class="validation-error">Minimum withdrawal amount is $30</div>
      
      <button id="requestWithdrawalBtn">Request Withdrawal</button>
      
      <h3 style="margin-top:1.5rem">Withdrawal History</h3>
      <table>
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Method</th>
          <th>Status</th>
        </tr>
        <tr>
          <td colspan="4" class="muted">No withdrawals yet</td>
        </tr>
      </table>
    </section>

    <!-- Profile -->
    <section id="profile" class="dashboard-card">
      <h2><i class="fas fa-user-circle"></i> Profile</h2>
      <p><strong>Email:</strong> <span id="profileEmail">‚Äî</span></p>
      <input type="email" id="updateEmail" placeholder="New email">
      <input type="password" id="updatePassword" placeholder="New password">
      <button id="saveProfileBtn">Update Profile</button>
    </section>

    <!-- Support -->
    <section id="support" class="dashboard-card">
      <h2><i class="fas fa-comment-dots"></i> Support</h2>
      <form id="supportForm" action="https://formspree.io/f/xdkdywpq" method="POST">
        <label>Subject:</label>
        <input type="text" name="subject" required>
        <label>Message:</label>
        <textarea name="message" required></textarea>
        <input type="hidden" name="email" id="supportEmail">
        <button type="submit">Send Message</button>
      </form>
    </section>

  </main>
</section>

<script>
/* ---------- Fixtures ---------- */
const DASH_FIXTURES = [
  {
    FixtureKey: "2025-09-13-brentford-vs-chelsea",
    dateISO: "2025-09-13T19:00:00Z",
    homeName: "Brentford",
    homeLogo: "https://totalsportek.army/assets2/images/premier/Brentford.png",
    awayName: "Chelsea",
    awayLogo: "https://totalsportek.army/assets2/images/premier/Chelsea.png",
    league: "Premier League",
    iframeHtml: null,
    status: "Upcoming"
  }
];

const PLACEHOLDER_IFRAME = "https://placeholder.com/embed";
const REVEAL_BEFORE_MS = 30 * 60 * 1000;
let currentFixtures = [];

/* ---------- Helpers ---------- */
function parseISO(s){ if(!s) return null; const d=new Date(s); return isNaN(d)?null:d; }
function isToday(iso){ const d=parseISO(iso); if(!d) return false; const n=new Date(); return d.getFullYear()===n.getFullYear()&&d.getMonth()===n.getMonth()&&d.getDate()===n.getDate(); }
function shouldReveal(kickoffIso){ const d=parseISO(kickoffIso); if(!d) return false; return Date.now() >= (d.getTime() - REVEAL_BEFORE_MS); }

/* ---------- Dashboard UI ---------- */
async function loadLocalDashboard(){
  currentFixtures = DASH_FIXTURES.filter(f=>isToday(f.dateISO))
    .map(f=>({...f, kickoffMs: parseISO(f.dateISO)?.getTime()||null}))
    .sort((a,b)=>(a.kickoffMs||0)-(b.kickoffMs||0));
  renderDashboardUI(currentFixtures);
}

function renderDashboardUI(fixtures){
  const sel = document.getElementById('streamSelect');
  const wrap = document.getElementById('thumbList');
  if(!sel || !wrap) return;

  sel.innerHTML = `<option value="">-- Choose a match --</option>`;
  wrap.innerHTML = "";

  if(!fixtures.length){
    sel.innerHTML = `<option value="">No fixtures</option>`;
    wrap.innerHTML = '<p>No fixtures found</p>';
    return;
  }

  fixtures.forEach((fx,i)=>{
    const opt = document.createElement('option'); opt.value = i;
    opt.textContent = `[${fx.league}] ${fx.homeName} vs ${fx.awayName}`;
    sel.appendChild(opt);

    const card = document.createElement('div'); card.className='card';
    card.innerHTML = `
      <div class="title">${fx.homeName} vs ${fx.awayName}</div>
      <div style="font-size:12px">League: ${fx.league}</div>
    `;
    card.addEventListener('click', ()=> {
      sel.value = i;
      showDashboardPreview(fx);
      document.querySelectorAll('#thumbList .card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
    });
    wrap.appendChild(card);
  });

  showDashboardPreview(fixtures[0]);
}

function showDashboardPreview(fx){
  const preview = document.getElementById('matchPreview');
  if(!preview) return;
  preview.style.display = 'block';
  const reveal = shouldReveal(fx.dateISO) && fx.iframeHtml;
  const embedHtml = reveal ? fx.iframeHtml : `<iframe src="${PLACEHOLDER_IFRAME}" allowfullscreen></iframe>`;
  preview.innerHTML = `
    <div><b>${fx.homeName} vs ${fx.awayName}</b></div>
    <div>${fx.league} ‚Ä¢ ${new Date(fx.dateISO).toLocaleString()}</div>
    <div>${embedHtml}</div>
  `;
}

/* ---------- Netlify deploy integration ---------- */
async function deployToNetlify(selectedDomain, filename, htmlContent, userId, fixtureKey) {
  try {
    const response = await fetch("/.netlify/functions/deploy-stream", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        domain: selectedDomain,
        filename,
        htmlContent,
        userId,
        fixtureKey
      })
    });

    const data = await response.json();
    if (data.success) {
      return data.url;
    } else {
      console.error("Deploy failed:", data);
      alert("Deployment failed. Please try again later.");
      return null;
    }
  } catch (err) {
    console.error("Error during Netlify deploy:", err);
    alert("Error deploying stream page.");
    return null;
  }
}

/* ---------- Launch Button ---------- */
function initializeLaunchButton() {
  const launchBtn = document.getElementById('launchBtn');
  const successMessage = document.getElementById('successMessage');
  if (!launchBtn) return;

  launchBtn.addEventListener('click', async () => {
    const domainSelect = document.getElementById('domainSelect');
    const selectedDomain = domainSelect?.value || '';
    const streamSelect = document.getElementById('streamSelect');
    const idx = parseInt(streamSelect?.value, 10);

    if (!selectedDomain) {
      alert('Please select a domain first.');
      return;
    }

    if (isNaN(idx)) {
      alert('Please select a stream first.');
      return;
    }

    const fx = currentFixtures[idx];
    if (!fx) {
      alert('Selected stream not found.');
      return;
    }

    const userId = localStorage.getItem("userId") || "guest";
    const streamPath = fx.homeName.replace(/\s+/g, '-').toLowerCase() + '-vs-' + fx.awayName.replace(/\s+/g, '-').toLowerCase();
    const publishedFile = streamPath + '.html';

    const monetization = getMonetizationSettings();
    const embedSrc = (shouldReveal(fx.dateISO) && fx.iframeHtml) ? fx.iframeHtml : PLACEHOLDER_IFRAME;
    const pageHtml = generateStreamHtml(selectedDomain, fx, embedSrc, monetization);

    const deployedUrl = await deployToNetlify(selectedDomain, publishedFile, pageHtml, userId, fx.FixtureKey);
    if (!deployedUrl) return;

    // Lock domain assignment
    if (!localStorage.getItem('assignedDomain')) {
      localStorage.setItem('assignedDomain', selectedDomain);
      if (domainSelect) domainSelect.disabled = true;
      document.getElementById('launchStatus').textContent = `Assigned domain: ${selectedDomain} (locked)`;
    }

    successMessage.innerHTML = `
      <strong>‚úÖ Stream Launched Successfully!</strong><br>
      Your stream is live: <a href="${deployedUrl}" target="_blank">${deployedUrl}</a><br>
      Share this link to start earning!
      <br><button id="copyStreamUrl" style="margin-top:8px;padding:8px 10px;border-radius:6px;border:none;background:#2563eb;color:#fff;cursor:pointer">Copy Stream URL</button>
    `;
    successMessage.style.display = 'block';

    const copyBtn = document.getElementById('copyStreamUrl');
    copyBtn?.addEventListener('click', () => {
      navigator.clipboard?.writeText(deployedUrl).then(() => {
        copyBtn.textContent = 'Copied!';
        setTimeout(() => (copyBtn.textContent = 'Copy Stream URL'), 2000);
      });
    });

    const streamSettings = {
      domain: selectedDomain,
      stream: fx.FixtureKey,
      monetization,
      generatedAt: new Date().toISOString(),
      publishedPath: publishedFile
    };
    localStorage.setItem('lastStreamLaunch', JSON.stringify(streamSettings));
  });
}

/* ---------- Monetization getter ---------- */
function getMonetizationSettings() {
  return {
    enabled: !!document.getElementById('enableMonetization')?.checked,
    nativeBanners: !!document.getElementById('enableNativeBanners')?.checked,
    popunders: !!document.getElementById('enablePopunders')?.checked,
    contentLocker: !!document.getElementById('enableContentLocker')?.checked,
    standardBanners: !!document.getElementById('enableStandardBanners')?.checked,
    smartlink: !!document.getElementById('enableSmartlink')?.checked
  };
}

/* ---------- Initialization ---------- */
document.addEventListener('DOMContentLoaded', async () => {
  await loadLocalDashboard();
  initializeLaunchButton();
});
</script>

</body>
</html>
